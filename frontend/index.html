<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SFP Wizard Community Tool</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
</head>

<body>

    <header>
        <h1>SFP Wizard Community Tool</h1>
    </header>

    <main class="container">
        <div id="supportBanner" class="hidden"></div>
        <!-- Section for connecting to the device -->
        <section class="card">
            <h2>1. Connection</h2>
            <button id="connectButton">Connect to SFP Wizard</button>
            <div class="status-grid">
                <span>BLE Status:</span>
                <span id="bleStatus" class="status-light" data-status="disconnected">Disconnected</span>
                <span>SFP Status:</span>
                <span id="sfpStatus" class="status-light" data-status="unknown">Unknown</span>
            </div>
        </section>

        <!-- Optional discovery section (limited scanning support) -->
        <section class="card">
            <h2>1a. Discover Devices (Experimental)</h2>
            <p style="margin-bottom: 0.5rem; color: var(--text-muted);">
                Experimental device discovery. Browser support varies. Safari has limited support.
            </p>
            <button id="scanButton" onclick="limitedScanTODO()">Scan for Devices (TODO)</button>
        </section>

        <!-- Section for reading live data from a connected module -->
        <section class="card">
            <h2>2. Live Module Data</h2>
            <button id="readSfpButton" disabled>Read SFP Data</button>
            <div id="liveDataArea" class="hidden">
                <h3>Live SFP Details</h3>
                <pre id="sfp-vendor"></pre>
                <pre id="sfp-model"></pre>
                <pre id="sfp-serial"></pre>

                <div class="save-area">
                    <input type="text" id="moduleNameInput" placeholder="Enter a friendly name (e.g., 'Cisco 10G')">
                    <button id="saveModuleButton" disabled>Save to Library</button>
                    <button id="uploadCommunityButton" disabled title="TODO: Implement community upload flow">Upload to Community (TODO)</button>
                </div>
            </div>
        </section>

        <!-- Section for managing the saved module library -->
        <section class="card">
            <h2>3. Saved Module Library</h2>
            <button id="loadModulesButton">Load Library</button>
            <div class="save-area" style="margin-top:0.75rem">
                <input type="file" id="importFileInput" accept=".json,.bin" style="margin-bottom:0.5rem" />
                <button id="importFromFileButton" title="TODO: Import module from file">Import From File (TODO)</button>
                <button id="backupAllButton" title="TODO: Export/backup all modules to file/CSV">Backup/Export All (TODO)</button>
            </div>
            <div id="moduleLibrary" class="hidden">
                <p>Select a module to write it to the connected SFP.</p>
                <ul id="moduleList">
                    <!-- Modules will be dynamically added here -->
                </ul>
            </div>
        </section>

        <!-- Community modules (import) TODO -->
        <section class="card">
            <h2>4. Community Modules (TODO)</h2>
            <p style="margin-bottom: 0.5rem; color: var(--text-muted);">
                Browse and import communityâ€‘shared modules from the sidecar site.
            </p>
            <button id="loadCommunityModulesButton" title="TODO: Fetch community index and list">Load Community Modules (TODO)</button>
            <div id="communityModuleLibrary" class="hidden">
                <ul id="communityModuleList"></ul>
            </div>
        </section>
    </main>

    <!-- A simple log console for debugging -->
    <footer>
        <h3>Log Console</h3>
        <div id="logConsole"></div>
    </footer>

</body>

</html>
